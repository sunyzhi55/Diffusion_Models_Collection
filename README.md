---
date: 2025-12-10T19:48:00
tags:
  - diffusion-models
  - ddpm
  - ddim
  - pytorch
  - generative-models
  - deep-learning
---


<div>
  <div align="center">
    <img src="https://capsule-render.vercel.app/api?type=waving&height=240&text=âœ¨%20Diffusion%20Models%20Collection&fontSize=40&fontAlign=50&fontColor=28F2E6&color=0:9AD6FF,50:C1A6FF,100:CFF7E6&desc=ä¸€ä¸ªå…¨é¢ã€å·¥ç¨‹åŒ–ã€åŸºäº%20PyTorch%20çš„ç°ä»£æ‰©æ•£æ¨¡å‹å®ç°åº“&descAlign=50&descAlignY=78&descSize=20&descColor=C8EFF0&animation=twinkling"/>
  </div>



  <div align="center">
    <img src="https://capsule-render.vercel.app/api?type=waving&height=240&text=âœ¨%20Diffusion%20Models%20Collection&fontSize=40&fontAlign=50&fontColor=FFD700&color=0:7000FF,50:FF006E,100:FF9F1C&desc=ä¸€ä¸ªå…¨é¢ã€å·¥ç¨‹åŒ–ã€åŸºäº%20PyTorch%20çš„ç°ä»£æ‰©æ•£æ¨¡å‹å®ç°åº“&descAlign=50&descAlignY=78&descSize=20&descColor=FFD6FF&animation=twinkling"/>
  </div>




  <div align="center">
    <img src="https://capsule-render.vercel.app/api?type=waving&height=240&text=âœ¨%20Diffusion%20Models%20Collection&fontSize=40&fontAlign=50&fontColor=E3FFF8&color=0:FF7F50,50:FF69B4,100:9932CC&desc=ä¸€ä¸ªå…¨é¢ã€å·¥ç¨‹åŒ–ã€åŸºäº%20PyTorch%20çš„ç°ä»£æ‰©æ•£æ¨¡å‹å®ç°åº“&descAlign=50&descAlignY=78&descSize=20&descColor=DDA0DD&animation=twinkling"/>
  </div>




  <div align="center">
    <img src="https://capsule-render.vercel.app/api?type=waving&height=250&text=âœ¨%20Diffusion%20Models%20Collection&fontSize=42&fontAlign=50&fontColor=5F1BFA&color=0:DCC6F0,50:FFD7E6,100:FFCDA5&desc=ä¸€ä¸ªå…¨é¢ã€å·¥ç¨‹åŒ–ã€åŸºäº%20PyTorch%20çš„ç°ä»£æ‰©æ•£æ¨¡å‹å®ç°åº“&descAlign=50&descAlignY=78&descSize=21&descColor=8F3D17&animation=twinkling"/>
  </div>

  <div align="center">
      <!-- æ¸å˜è‰²è°±ï¼šä»æ©™è‰²åˆ°ç´«è‰² -->
      <img src="https://img.shields.io/badge/Framework-PyTorch-FF9A8B?style=for-the-badge&logo=pytorch&logoColor=white" alt="Framework">
      <img src="https://img.shields.io/badge/Models-DDPM%20%7C%20DDIM-FF8288?style=for-the-badge&logoColor=white" alt="Models">
      <img src="https://img.shields.io/badge/Backbones-UNet%20%7C%20DiT-E06A9C?style=for-the-badge&logoColor=white" alt="Backbones">
      <img src="https://img.shields.io/badge/License-MIT-B552A3?style=for-the-badge&logoColor=white" alt="License">
      <img src="https://img.shields.io/badge/Python-3.8%2B-8E44AD?style=for-the-badge&logo=python&logoColor=white" alt="Python">
  </div>

[![PyTorch](https://img.shields.io/badge/Framework-PyTorch-EE4C2C?style=flat&logo=pytorch&logoColor=white)](https://pytorch.org/)
[![Models](https://img.shields.io/badge/Models-DDPM%20%7C%20DDIM-7F78D2?style=flat)](https://arxiv.org/abs/2006.11239)
[![Backbones](https://img.shields.io/badge/Backbones-UNet%20%7C%20DiT%20%7C%20DiM-6CC7F6?style=flat)](https://github.com/facebookresearch/DiT)
[![License](https://img.shields.io/badge/License-MIT-green?style=flat)](LICENSE)
[![Python](https://img.shields.io/badge/Python-3.8%2B-blue?style=flat&logo=python&logoColor=white)](https://www.python.org/)
</div>


---

<div align="center">

# âœ¨ Diffusion Models Collection

**ä¸€ä¸ªå…¨é¢ã€å·¥ç¨‹åŒ–ã€åŸºäº PyTorch çš„ç°ä»£æ‰©æ•£æ¨¡å‹å®ç°åº“ã€‚**

æ”¯æŒ DDPMã€DDIMã€CFG ç­‰å¤šç§æ‰©æ•£ç®—æ³•ï¼Œé›†æˆ UNetã€DiTã€DiM ç­‰å…ˆè¿›ä¸»å¹²ç½‘ç»œã€‚  
æä¾›åˆ†å¸ƒå¼è®­ç»ƒã€EMAã€å®éªŒè¿½è¸ªã€å®Œæ•´è¯„ä¼°æŒ‡æ ‡ï¼Œå¼€ç®±å³ç”¨ã€‚

[ç®€ä»‹](#-1-ç®€ä»‹) â€¢ [é¡¹ç›®ç»“æ„](#-3-é¡¹ç›®ç»“æ„) â€¢ [å®‰è£…æŒ‡å—](#ï¸-4-å®‰è£…æŒ‡å—) â€¢ [å¿«é€Ÿå¼€å§‹](#-5-å¿«é€Ÿå¼€å§‹)
</div>


[English](README_EN.md) | [ä¸­æ–‡](README.md)
---

## ğŸ“– 1 ç®€ä»‹

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªæ¨¡å—åŒ–ä¸”æ˜“äºæ‰©å±•çš„å»å™ªæ‰©æ•£æ¦‚ç‡æ¨¡å‹ (DDPM) å’Œå»å™ªæ‰©æ•£éšå¼æ¨¡å‹ (DDIM) å®ç°ã€‚æ”¯æŒå¤šç§ä¸»æµçš„ä¸»å¹²ç½‘ç»œæ¶æ„ï¼ŒåŒ…æ‹¬ç»å…¸çš„ **UNet**ã€åŸºäº Transformer çš„ **DiT** (Diffusion Transformer) ä»¥åŠæœ€å‰æ²¿çš„ **DiM** (Diffusion Mamba)ã€‚

é¡¹ç›®ä¸“ä¸ºç ”ç©¶å’Œå·¥ç¨‹è½åœ°è®¾è®¡ï¼Œæä¾›äº†ç»Ÿä¸€çš„è®­ç»ƒã€é‡‡æ ·å’Œè¯„ä¼°æ¥å£ï¼Œå¹¶æ”¯æŒå¤š GPU åˆ†å¸ƒå¼è®­ç»ƒ (DDP) å’Œå®éªŒè¿½è¸ªã€‚

## ğŸš€ 2 åŠŸèƒ½ç‰¹æ€§

- **ğŸ§  å…ˆè¿›çš„ä¸»å¹²ç½‘ç»œ (Backbones)**
  - **UNet**: ç»å…¸çš„æ®‹å·®å— + è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¶æ„ã€‚
  - **DiT**: å¯æ‰©å±•çš„ Diffusion Transformer æ¶æ„ã€‚
  - **DiM**: é«˜æ•ˆçš„ Diffusion Mamba (çŠ¶æ€ç©ºé—´æ¨¡å‹) æ¶æ„ã€‚

- **âš¡ é‡‡æ ·ç­–ç•¥**
  - **DDPM**: æ ‡å‡†éšæœºé‡‡æ ·ï¼Œç”Ÿæˆè´¨é‡é«˜ã€‚
  - **DDIM**: ç¡®å®šæ€§åŠ é€Ÿé‡‡æ ·ï¼Œæ¨ç†é€Ÿåº¦å¿«ã€‚
  - **CFG**: æ— åˆ†ç±»å™¨å¼•å¯¼ (Classifier-Free Guidance)ï¼Œç”¨äºæ¡ä»¶ç”Ÿæˆã€‚

- **ğŸ“¦ å…¨é¢çš„æ•°æ®é›†æ”¯æŒ**
  - å†…ç½®æ”¯æŒ: CIFAR-10, CIFAR-100, MNIST, FashionMNIST, CelebAã€‚
  - **è‡ªå®šä¹‰æ•°æ®é›†**: æ”¯æŒé€šè¿‡æ–‡ä»¶å¤¹ç»“æ„æˆ– JSON æ ‡ç­¾æ–‡ä»¶çµæ´»åŠ è½½ç§æœ‰æ•°æ®ã€‚

- **ğŸ› ï¸ å·¥ç¨‹åŒ–ç‰¹æ€§**
  - **åˆ†å¸ƒå¼è®­ç»ƒ**: æ— ç¼æ”¯æŒ DDP (Distributed Data Parallel) å¤šå¡è®­ç»ƒã€‚
  - **EMA**: æŒ‡æ•°ç§»åŠ¨å¹³å‡ (Exponential Moving Average)ï¼Œç¨³å®šæ¨¡å‹æƒé‡ã€‚
  - **å®éªŒè¿½è¸ª**: é›†æˆ [SwanLab](https://swanlab.cn) å®ç°å®æ—¶è®­ç»ƒç›‘æ§ã€‚
  - **è¯„ä¼°æŒ‡æ ‡**: å†…ç½® FID, Inception Score (IS), å’Œ LPIPS è®¡ç®—å·¥å…·ã€‚

---

## ğŸ“‚ 3 é¡¹ç›®ç»“æ„

```text
DDPM_structure/
â”œâ”€â”€ configs/                # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ cifar10_dim.py
â”‚   â”œâ”€â”€ cifar10_dit.py
â”‚   â”œâ”€â”€ cifar10_dit.yml
â”‚   â”œâ”€â”€ cifar10_unet.py
â”‚   â””â”€â”€ cifar10_unet.yml
â”œâ”€â”€ datasets/               # æ•°æ®é›†åŠ è½½é€»è¾‘
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_dataset.py
â”‚   â””â”€â”€ custom_dataset.py
â”œâ”€â”€ diffusion/              # æ‰©æ•£è¿‡ç¨‹æ ¸å¿ƒ (DDPM/DDIM)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ddpm.py
â”‚   â””â”€â”€ ddim.py
â”œâ”€â”€ metrics/                # è¯„ä¼°æŒ‡æ ‡è®¡ç®—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ fid.py
â”‚   â”œâ”€â”€ inception_score.py
â”‚   â””â”€â”€ lpips_score.py
â”œâ”€â”€ models/                 # æ¨¡å‹ä¸»å¹²æ¶æ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ unet.py
â”‚   â”œâ”€â”€ dit.py
â”‚   â””â”€â”€ dim.py
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ trainer.py
â”‚   â””â”€â”€ helpers.py
â”œâ”€â”€ train.py                # è®­ç»ƒä¸»è„šæœ¬
â”œâ”€â”€ sample.py               # æ¨ç†/é‡‡æ ·è„šæœ¬
â”œâ”€â”€ evaluate.py             # è¯„ä¼°è„šæœ¬
â”œâ”€â”€ requirements.txt        # ä¾èµ–åˆ—è¡¨
â””â”€â”€ LICENSE                 # è®¸å¯è¯æ–‡ä»¶
```

---

## ğŸ› ï¸ 4 å®‰è£…æŒ‡å—

1. **å…‹éš†ä»“åº“**
   ```bash
   git clone https://github.com/sunyzhi55/Diffusion_Models_Collection.git
   cd Diffusion_Models_Collection
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

3. **(å¯é€‰) å®‰è£… Mamba**
   å¦‚æœä½ è®¡åˆ’ä½¿ç”¨ DiM (Mamba) æ¨¡å‹ï¼š
   ```bash
   pip install mamba-ssm
   ```

---

## âš¡ 5 å¿«é€Ÿå¼€å§‹

### 5.1 è®­ç»ƒ (Training)

`train.py` è„šæœ¬åŒæ—¶æ”¯æŒå•å¡å’Œå¤šå¡ (DDP) è®­ç»ƒã€‚

**å…³äº CFG è®­ç»ƒï¼ˆæ— åˆ†ç±»å™¨å¼•å¯¼ï¼‰**
- è‹¥ `conditional=True`ï¼Œæ•°æ®é›†æ ‡ç­¾ä¼šåœ¨å†…éƒ¨æ•´ä½“ +1ï¼Œ0 ä¸“é—¨ä¿ç•™ä¸ºâ€œæ— æ¡ä»¶â€æ ‡ç­¾ï¼›è¯·ç¡®ä¿ `num_classes` ä¸æ•°æ®ä¸€è‡´ã€‚
- é€šè¿‡ `cfg_dropout_prob`ï¼ˆé…ç½®é¡¹ï¼Œé»˜è®¤ 0.2ï¼‰éšæœºå°†éƒ¨åˆ†æ ·æœ¬çš„æ ‡ç­¾ç½®ä¸º 0ï¼Œç”¨äºè®­ç»ƒæ— æ¡ä»¶åˆ†æ”¯ï¼›è®¾ä¸º 0 å¯å…³é—­ã€‚
- DDP ä¸‹ä¸éœ€è¦ `find_unused_parameters=True`ï¼Œå› ä¸ºç©ºæ ‡ç­¾ä»èµ°åŒä¸€å‰å‘åˆ†æ”¯ã€‚

1ã€**å• GPU è®­ç»ƒ:**

ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ `gpu_ids`

```python
config = {
    # ...
    'gpu_ids': [0],  # ä½¿ç”¨ GPU 0
    # ...
}
```

ç„¶åè¿è¡Œï¼š

```bash
# åœ¨ CIFAR-10 ä¸Šè®­ç»ƒ UNet
python train.py --config configs/cifar10_unet.py

# è®­ç»ƒ DiT æ¨¡å‹
python train.py --config configs/cifar10_dit.py
```

2ã€**å¤š GPU åˆ†å¸ƒå¼è®­ç»ƒ (DDPï¼ŒåŸºäº torchrun):**

å¤šå¡å¯åŠ¨ä¸å†ä½¿ç”¨ `torch.multiprocessing`ï¼Œè¯·é€šè¿‡ `torchrun` ç®¡ç†è¿›ç¨‹ï¼Œå¯é€‰ `gpu_ids` æ§åˆ¶å…·ä½“å¡ï¼š

```bash
# ä½¿ç”¨ 4 å¼  GPU è¿›è¡Œè®­ç»ƒ
torchrun --nproc_per_node=4 --master_port=12355 train.py --config configs/cifar10_unet.py

# nohup ç¤ºä¾‹ï¼ˆåå°è¿è¡Œï¼‰
nohup setsid torchrun --nproc_per_node=2 --master_port=15355 train.py --config configs/cifar10_unet.py > result.out &
```

> è¯´æ˜ï¼š
> - `--nproc_per_node` æ§åˆ¶å•æœºè¿›ç¨‹æ•°ï¼ˆé€šå¸¸ç­‰äºä½¿ç”¨çš„ GPU æ•°ï¼‰ã€‚
> - å¯é€‰ `--master_port` æ§åˆ¶é€šä¿¡ç«¯å£ï¼ˆä¹Ÿå¯åœ¨é…ç½®æ–‡ä»¶è®¾ç½® `port`ï¼‰ã€‚
> - å¦‚éœ€æŒ‡å®šå…·ä½“ GPUï¼Œå¯åœ¨é…ç½®æ–‡ä»¶è®¾ç½® `gpu_ids`ï¼ˆé•¿åº¦éœ€ç­‰äº `WORLD_SIZE`/`--nproc_per_node`ï¼‰ï¼Œtorchrun ä¼šæŒ‰ `LOCAL_RANK` æ˜ å°„åˆ°è¯¥åˆ—è¡¨ï¼›æˆ–ç›´æ¥åœ¨å¯åŠ¨å‰è®¾ç½® `CUDA_VISIBLE_DEVICES`ã€‚

3ã€**æ–­ç‚¹ç»­è®­ (Resume Training):**

åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® `resume_path` ä¸ºæ£€æŸ¥ç‚¹è·¯å¾„ï¼Œæˆ–è€…ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š

```python
# configs/cifar10_unet.py
config = {
    # ...
    'resume_path': 'checkpoints/cifar10-unet-ddpm/model_epoch_0050.pth',
    # ...
}
```

> **å¦‚æœå½“å‰é…ç½®æ–‡ä»¶ä¸­çš„epochæ•°å°äºç­‰äºå·²è®­ç»ƒçš„epochæ•°ï¼Œè®­ç»ƒä¼šè‡ªåŠ¨å»¶é•¿è‡³æ–°çš„æ€»epochæ•°ã€‚**
>
> **å¦‚æœå½“å‰é…ç½®æ–‡ä»¶ä¸­çš„epochæ•°å¤§äºå·²è®­ç»ƒçš„epochæ•°ï¼Œé‚£ä¹ˆæŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­çš„epochæ•°ç»§ç»­è®­ç»ƒã€‚**

ç„¶åæ­£å¸¸è¿è¡Œè®­ç»ƒå‘½ä»¤å³å¯ã€‚

### 5.2 é‡‡æ · / æ¨ç† (Sampling)

ä½¿ç”¨ `sample.py` åŠ è½½è®­ç»ƒå¥½çš„æƒé‡ç”Ÿæˆå›¾åƒã€‚

**å…³äº CFG é‡‡æ ·**
- ä¼ å…¥çš„ labels èŒƒå›´åº”ä¸ºçœŸå®ç±»åˆ«ç´¢å¼• `[0, num_classes-1]`ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ•´ä½“ +1 å¹¶ä¿è¯ä¸ä¼šæŠŠ 0 å–‚ç»™æ¨¡å‹ï¼ˆ0 ä¿ç•™ä¸ºæ— æ¡ä»¶ï¼‰ã€‚
- `cfg_scale` æ§åˆ¶å¼•å¯¼å¼ºåº¦ï¼Œå¸¸ç”¨ 1.5â€“3.0ï¼›è¿‡å¤§å¯èƒ½å¯¼è‡´ä¼ªå½±æˆ–å‘æ•£ã€‚
- å»ºè®®é‡‡æ ·æ—¶å¯ç”¨ `--use_ema` è·å¾—æ›´å¹³æ»‘çš„ç”Ÿæˆè´¨é‡ã€‚

**æ ‡å‡† DDPM é‡‡æ ·:**
```bash
python sample.py \
    --checkpoint checkpoints/cifar10-unet-ddpm/best_model.pth \
    --sampling_method ddpm \
    --num_samples 64 \
    --batch_size 16 \
    --output_dir ./generated_images \
    --use_ema
```

**åŠ é€Ÿ DDIM é‡‡æ ·:**
```bash
python sample.py \
    --checkpoint checkpoints/cifar10-unet-ddpm/best_model.pth \
    --sampling_method ddim \
    --num_inference_steps 50 \
    --num_samples 64 \
    --use_ema
```

**å¸¦ CFG çš„æ¡ä»¶ç”Ÿæˆ:**
```bash
python sample.py \
    --checkpoint checkpoints/best_model.pth \
    --sampling_method ddim \
    --cfg_scale 4.0 \
    --labels "0,1,2,3" \
    --use_ema
```
> è¯´æ˜ï¼š`--labels` æ¥å—çœŸå®ç±»åˆ«ç´¢å¼•ï¼ˆ0 å¼€å§‹ï¼‰ï¼Œè„šæœ¬å†…éƒ¨ä¼šè‡ªåŠ¨ +1ï¼Œ0 ä¸ä¼šä½œä¸ºè¾“å…¥æ ‡ç­¾ï¼›è‹¥ä¸æŒ‡å®š labelsï¼Œåˆ™æŒ‰è¡Œéšæœºé‡‡æ ·ç±»åˆ«ã€‚

**ç”Ÿæˆ GIF åŠ¨ç”»ä¸ä¿å­˜ä¸­é—´è¿‡ç¨‹:**
```bash
# ç”Ÿæˆ GIF åŠ¨ç”»
python sample.py \
    --checkpoint checkpoints/best_model.pth \
    --create_gif \
    --output_dir ./results

# ç”Ÿæˆ GIF å¹¶ä¿å­˜ä¸­é—´å¸§
python sample.py \
    --checkpoint checkpoints/best_model.pth \
    --create_gif \
    --save_intermediate \
    --output_dir ./results

# ä½¿ç”¨ DDIM åŠ é€Ÿé‡‡æ ·å¹¶ç”Ÿæˆ GIF (æ¨è)
python sample.py \
    --checkpoint checkpoints/best_model.pth \
    --sampling_method ddim \
    --num_inference_steps 50 \
    --create_gif
```

### 5.3 è¯„ä¼° (Evaluation)

è®¡ç®— FID, IS, å’Œ LPIPS æŒ‡æ ‡ã€‚

```bash
python evaluate.py \
    --checkpoint checkpoints/best_model.pth \
    --num_samples 10000 \
    --batch_size 32 \
    --save_images_dir ./eval_generated_images \
    --use_ema \
    --output metrics_report.json
```

> [!note]
>
> è¯´æ˜ï¼šå¦‚æœè®­ç»ƒä½¿ç”¨äº†æ¡ä»¶æ‰©æ•£æ–¹å¼ï¼Œåœ¨æ¨¡å‹è¯„ä¼°æ—¶ä¼šè‡ªåŠ¨é€‰æ‹©è¿›è¡Œæ¡ä»¶æ‰©æ•£ï¼Œå¹¶ä¸”ç›´æ¥å¤ç”¨çœŸå®æ•°æ®çš„æ ‡ç­¾ï¼ˆæ•´ä½“ +1ï¼Œ0 ä¸ºç©ºæ ‡ç­¾ï¼‰ï¼Œä»è€ŒåŒ¹é…çœŸå®ç±»åˆ«åˆ†å¸ƒï¼›è¯·ç¡®ä¿è¯„ä¼°æ•°æ®é›†èƒ½è¿”å›æ ‡ç­¾ï¼Œä¸” `num_classes` ä¸æ•°æ®ä¸€è‡´ï¼›è¯·ä½¿ç”¨ `--cfg_scale` (æ¨èä¸º 1.5â€“3.0) å¯ç”¨/è°ƒæ•´ CFG é‡‡æ ·ã€`--cfg_scale` å‚æ•°å¿…é¡»ä½¿ç”¨ã€‘ã€‚

---

## âš™ï¸ 6 é…ç½®è¯´æ˜

é…ç½®æ–‡ä»¶é‡‡ç”¨ Python æ ¼å¼ (ä¾‹å¦‚ `configs/cifar10_unet.py`)ï¼Œæä¾›æœ€å¤§çš„çµæ´»æ€§ã€‚

```python
config = {
    # é¡¹ç›®å…ƒæ•°æ®
    'project_name': 'diffusion-models',
    'experiment_name': 'cifar10-unet',
    'resume_path': None,    # ç»­è®­æ£€æŸ¥ç‚¹è·¯å¾„

    # æ¨¡å‹æ¶æ„
    'model_type': 'unet',   # é€‰é¡¹: 'unet', 'dit', 'dim'
    'model_params': {
        'image_size': (32, 32),
        'in_channels': 3,
        # ... ç‰¹å®šæ¨¡å‹å‚æ•°
    },

    # æ•°æ®é›†
    'dataset': 'cifar10',
    'conditional': True,
    'num_classes': 10,

    # è®­ç»ƒè¶…å‚æ•°
    'epochs': 200,
    'batch_size': 128,
    'learning_rate': 2e-4,
    
    # æ‰©æ•£å‚æ•°
    'num_timesteps': 1000,
    'beta_schedule': 'linear',
}
```

---

## ğŸ—‚ï¸ 7 è‡ªå®šä¹‰æ•°æ®é›†

ä½ å¯ä»¥ä½¿ç”¨ `custom` æ¨¡å¼åœ¨è‡ªå·±çš„æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒã€‚

**æ–¹å¼ 1: æ–‡ä»¶å¤¹ç»“æ„ (æŒ‰ç±»åˆ«åˆ†æ–‡ä»¶å¤¹)**
```text
data/
â”œâ”€â”€ dog/
â”‚   â”œâ”€â”€ img1.jpg
â”‚   â””â”€â”€ ...
â”œâ”€â”€ cat/
â”‚   â”œâ”€â”€ img1.jpg
â”‚   â””â”€â”€ ...
```

**æ–¹å¼ 2: æ‰å¹³æ–‡ä»¶å¤¹ + JSON æ ‡ç­¾**
labels.json æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š
```json

{
  "img1.jpg": 0,
  "img2.jpg": 1
}
```

**é…ç½®è®¾ç½®:**
```python
config = {
    'dataset': 'custom',
    'data_root': './path/to/data',
    'use_subdirs': True,  # å¦‚æœä½¿ç”¨ JSON æ–¹å¼ï¼Œè®¾ä¸º False
    'label_file': None,   # å¦‚æœä¸ä½¿ç”¨å­ç›®å½•æ–¹å¼ï¼ŒæŒ‡å®š JSON è·¯å¾„
}
```

---

## ğŸ“ˆ 8 å®éªŒè¿½è¸ª

æœ¬é¡¹ç›®æ”¯æŒä½¿ç”¨ [SwanLab](https://swanlab.cn) è¿›è¡Œè®­ç»ƒæŒ‡æ ‡çš„å¯è§†åŒ–ç›‘æ§ã€‚

åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨:
```python
config = {
    'use_swanlab': True,
    'project_name': 'diffusion-models',
    # ...
}
```

---

## ğŸ“Š 9 å®éªŒè®°å½•

- CIFAR-10 æ¡ä»¶ç”Ÿæˆä¸‰ç»„è®­ç»ƒ/é‡‡æ ·/è¯„ä¼°æ‘˜è¦è§ [docs/cifar10_runs.md](docs/cifar10_runs.md)ã€‚

---


## ğŸŒ¸ 10 Oxford Flowers æ•°æ®é›†é‡‡æ ·å±•ç¤º

æœ¬é¡¹ç›®æ”¯æŒå¯¹ **Oxford Flowers 102** æ•°æ®é›†è¿›è¡Œè®­ç»ƒä¸é‡‡æ ·ã€‚ä»¥ä¸‹å±•ç¤ºäº†æ¨¡å‹åœ¨è¯¥æ•°æ®é›†ä¸Šçš„ç”Ÿæˆæ•ˆæœç¤ºä¾‹ã€‚

### ğŸ“· 10.1 é‡‡æ ·å›¾åƒ (PNG)

(å·¦: ddpm é‡‡æ ·ç»“æœ | å³: ddim é‡‡æ ·ç»“æœ)

<div align="center" style="display: flex; justify-content: center; gap: 20px;">
  <img src="./assets/samples_01.png" width="260" />
  <img src="./assets/samples_02.png" width="260" />
</div>


### ğŸï¸ 10.2 å»å™ªè¿‡ç¨‹ GIF åŠ¨ç”»

ddim é‡‡æ ·è¿‡ç¨‹ã€‚GIF åŠ¨ç”»å±•ç¤ºäº†æ¨¡å‹ä»çº¯å™ªå£°é€æ­¥ç”Ÿæˆæ¸…æ™°å›¾åƒçš„è¿‡ç¨‹ã€‚

<div align="center">
  <img src="./assets/samples_ddim.gif" width="360" />
</div>

---

## ğŸ“œ 11 è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚é˜… [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---
âœ… ç°åœ¨å°±å…‹éš†é¡¹ç›®ï¼Œå¼€å¯ä½ çš„æ‰©æ•£æ¨¡å‹ä¹‹æ—…å§ï¼

---


<div align="center">
  <img src="https://capsule-render.vercel.app/api?type=waving&color=0:A875FF,100:6FFBFF&height=240&section=header&text=âœ¨%20Enjoy%20Building%20Your%20Model!%20âœ¨&fontSize=44&animation=twinkling&fontAlignY=48&fontColor=3A1BFC" width="100%" alt="Header Banner" />
</div>
